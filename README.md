# Rive Elastic Curve - 使用指南

## 简介

Rive Elastic Curve 是一个 After Effects 插件，可以将 Rive 动画系统中的弹性曲线应用到 AE 的关键帧上。

## 版本说明

本插件提供两个版本：

### 🌟 单文件版本（推荐）- `RiveElasticCurve-standalone.jsx`

- **推荐使用**：所有代码合并在一个文件中，兼容性最好
- **优点**：
  - 无需外部依赖，不依赖 `$.evalFile()`
  - 安装简单，只需一个文件
  - 在所有 AE 版本和环境下都能稳定运行
- **适用场景**：日常使用、生产环境

### 多文件版本 - `RiveElasticCurve.jsx`

- **开发版本**：代码分模块组织（Model、View、ViewModel）
- **优点**：代码结构清晰，便于维护和开发
- **缺点**：依赖 `$.evalFile()` 加载外部文件，在某些环境下可能不稳定
- **适用场景**：开发和调试

**建议：如果你只是想使用插件，请使用单文件版本 `RiveElasticCurve-standalone.jsx`。**

---

## 安装

### 方法 1：临时运行（推荐用于测试）

1. 打开 After Effects
2. 选择 `文件` > `脚本` > `运行脚本文件...`
3. 选择 `RiveElasticCurve-standalone.jsx`（推荐）或 `RiveElasticCurve.jsx`

### 方法 2：安装到脚本面板（推荐用于日常使用）

1. 找到 AE 的 ScriptUI Panels 目录：
   - **macOS**: `/Applications/Adobe After Effects 2024/Scripts/ScriptUI Panels/`
   - **Windows**: `C:\Program Files\Adobe\Adobe After Effects 2024\Support Files\Scripts\ScriptUI Panels\`

2. 将 `RiveElasticCurve-standalone.jsx` 复制到该目录

3. 重启 After Effects

4. 在 `窗口` 菜单中找到 `RiveElasticCurve-standalone.jsx`

**注意**：如果你想使用多文件版本进行开发，可以将整个项目文件夹复制到该目录。

---

## 使用方法

### 步骤 1：准备关键帧

1. 在 AE 中创建一个合成
2. 为图层的属性（如位置、缩放、旋转等）添加至少 **2 个关键帧**
3. 选中该属性（在时间轴中点击属性名称）

### 步骤 2：配置参数

打开插件面板，配置以下参数：

| 参数 | 说明 | 范围 | 默认值 |
|------|------|------|--------|
| **振幅 (Amplitude)** | 控制弹性振荡的幅度 | 0.1 - 10.0 | 1.0 |
| **周期 (Period)** | 控制振荡的周期 | 0.1 - 5.0 | 0.5 |
| **缓动类型** | 缓动方向 | Ease In / Out / In-Out | Ease Out |

### 步骤 3：应用

1. 点击 **"应用到选中关键帧"** 按钮
2. 插件会自动为选中的属性添加表达式
3. 播放预览查看效果

---

## 参数说明

### 振幅 (Amplitude)

- **值越大**：弹性效果越明显，振荡幅度越大
- **值越小**：弹性效果越柔和
- **推荐值**：
  - 轻微弹性：0.5 - 1.0
  - 中等弹性：1.0 - 2.0
  - 强烈弹性：2.0 - 5.0

### 周期 (Period)

- **值越大**：振荡周期越长，弹性持续时间越长
- **值越小**：振荡周期越短，弹性快速衰减
- **推荐值**：
  - 快速衰减：0.1 - 0.3
  - 标准效果：0.3 - 0.7
  - 缓慢衰减：0.7 - 2.0

### 缓动类型

- **Ease Out**：从快到慢，结束时有弹性（最常用）
- **Ease In**：从慢到快，开始时有弹性
- **Ease In-Out**：两端都有弹性效果

---

## 示例场景

### 场景 1：UI 按钮弹跳

```
振幅: 1.5
周期: 0.4
缓动: Ease Out
```

### 场景 2：物体落地反弹

```
振幅: 2.0
周期: 0.6
缓动: Ease Out
```

### 场景 3：弹簧效果

```
振幅: 3.0
周期: 1.0
缓动: Ease In-Out
```

---

## 常见问题

### Q: 为什么运行脚本后看不到 UI 窗口？

A: 这个问题在 v1.0.4 中已修复。如果你使用的是旧版本：
1. 请更新到最新版本（v1.0.4 或更高）
2. 确保使用的是 `RiveElasticCurve-standalone.jsx`
3. 通过"文件 > 脚本 > 运行脚本文件"方式运行

**技术说明**: v1.0.4 将窗口类型从 `palette` 改为 `dialog`，解决了在"运行脚本文件"模式下窗口不显示的问题。详见 `UI_FIX_DOCUMENTATION.md`。

### Q: 为什么点击"应用"后没有效果？

A: 请检查：
1. 是否选中了属性（在时间轴中点击属性名称）
2. 该属性是否有至少 2 个关键帧
3. 是否打开了合成

### Q: 可以应用到哪些属性？

A: 支持所有可以添加表达式的属性，包括：
- 位置 (Position)
- 缩放 (Scale)
- 旋转 (Rotation)
- 不透明度 (Opacity)
- 锚点 (Anchor Point)
- 等等...

### Q: 如何移除弹性效果？

A: 在时间轴中选中属性，按 `Alt + Shift + =` (Windows) 或 `Option + Shift + =` (Mac) 禁用表达式。

### Q: 可以同时应用到多个属性吗？

A: 可以！同时选中多个属性，点击"应用"即可。

---

## 技术说明

### 表达式原理

插件会为选中的属性添加一个 JavaScript 表达式，该表达式：
1. 读取关键帧的时间和值
2. 计算当前时间在关键帧之间的进度
3. 应用 Rive 弹性曲线公式
4. 输出插值后的值

### 性能

- 表达式在 AE 中实时计算
- 对性能影响极小
- 可以安全地应用到多个属性

---

## 更新日志

### v1.0.4 (2026-02-19)
- 🐛 **修复**: UI 窗口不显示的问题
- 将窗口类型从 `palette` 改为 `dialog`，确保在"运行脚本文件"模式下正常显示
- 添加详细的 UI 修复文档 (`UI_FIX_DOCUMENTATION.md`)
- 添加 UI 测试脚本 (`test-ui.jsx`)

### v1.0.3 (2026-02-16)
- 🌟 新增单文件版本 `RiveElasticCurve-standalone.jsx`
- 解决 `$.evalFile()` 在某些环境下的兼容性问题
- 推荐使用单文件版本以获得最佳稳定性
- 保留多文件版本用于开发和维护

### v1.0.0 (2026-02-16)
- 初始版本
- 支持 Rive 弹性曲线的三种缓动类型
- MVVM 架构设计
- 完整的参数验证

---

## 支持

如有问题或建议，请联系开发者。

---

## 许可证

MIT License
